<!-- Font Awesome para os ícones das redes sociais -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
<article class="noticia-page">
  <!-- Loading -->
  <div class="loading" *ngIf="loading">
    <div class="spinner"></div>
    <p>Carregando notícia...</p>
  </div>

  <!-- Erro -->
  <div class="erro" *ngIf="erro && !loading">
    <span class="material-icons">error_outline</span>
    <h2>Notícia não encontrada</h2>
    <p>{{ erro }}</p>
    <div class="btns">
      <button (click)="voltar()">Voltar para notícias</button>
      <a routerLink="/">Ir para Home</a>
    </div>
  </div>

  <!-- Notícia -->
  <div class="content" *ngIf="noticia && !loading && !erro">
    <!-- Breadcrumb -->
    <nav class="breadcrumb">
      <a routerLink="/noticias">← Voltar para notícias</a>
    </nav>

    <!-- Header -->
    <header class="article-header">
      <span class="categoria" *ngIf="noticia.categoria">{{ noticia.categoria }}</span>

      <h1>{{ noticia.titulo }}</h1>
      <p class="resumo">{{ noticia.resumo }}</p>

      <div class="meta">
        <div class="item">
          <span class="material-icons">event</span>
          <span>{{ formatarData(noticia.dataPublicacao) }}</span>
        </div>

        <div class="item">
          <span class="material-icons">schedule</span>
          <span>{{ calcularTempoLeitura() }} min de leitura</span>
        </div>

        <div class="item" *ngIf="noticia.autorNome">
          <span class="material-icons">person</span>
          <span>{{ noticia.autorNome }}</span>
        </div>

        <div class="item" *ngIf="noticia.visualizacoes > 0">
          <span class="material-icons">visibility</span>
          <span>{{ noticia.visualizacoes }} visualizações</span>
        </div>

        <div class="item" *ngIf="noticia.fonteNome">
          <span class="material-icons">public</span>
          <span>{{ noticia.fonteNome }}</span>
        </div>
      </div>
    </header>

    <!-- Imagem de Capa -->
    <figure class="cover" *ngIf="noticia.imagemCapa">
      <img [src]="noticia.imagemCapa" [alt]="noticia.titulo" (error)="onImageError($event)">
    </figure>

    <!-- Conteúdo -->
    <div class="article-body" [innerHTML]="getConteudoSeguro()"></div>

    <!-- ✅ Compartilhar nas Redes Sociais -->
    <section class="social-share">
      <h3>Compartilhe esta notícia</h3>

      <div class="social-buttons">
        <button class="social-btn facebook" (click)="compartilhar('facebook')" title="Compartilhar no Facebook">
          <i class="fab fa-facebook-f"></i>
          <span>Facebook</span>
        </button>

        <button class="social-btn twitter" (click)="compartilhar('twitter')" title="Compartilhar no Twitter/X">
          <i class="fab fa-x-twitter"></i>
          <span>Twitter</span>
        </button>

        <button class="social-btn whatsapp" (click)="compartilhar('whatsapp')" title="Compartilhar no WhatsApp">
          <i class="fab fa-whatsapp"></i>
          <span>WhatsApp</span>
        </button>

        <button class="social-btn linkedin" (click)="compartilhar('linkedin')" title="Compartilhar no LinkedIn">
          <i class="fab fa-linkedin-in"></i>
          <span>LinkedIn</span>
        </button>

        <button class="social-btn telegram" (click)="compartilhar('telegram')" title="Compartilhar no Telegram">
          <i class="fab fa-telegram-plane"></i>
          <span>Telegram</span>
        </button>

        <button class="social-btn email" (click)="compartilhar('email')" title="Compartilhar por Email">
          <i class="fas fa-envelope"></i>
          <span>Email</span>
        </button>

        <button class="social-btn copy" (click)="copiarLink()" [class.copied]="linkCopiado" title="Copiar link">
          <i class="fas" [ngClass]="linkCopiado ? 'fa-check' : 'fa-link'"></i>
          <span>{{ linkCopiado ? 'Copiado!' : 'Copiar link' }}</span>
        </button>
      </div>
    </section>

    <!-- ✅ Fonte / Créditos -->
    <section class="source-box"
      *ngIf="noticia.fonteNome || noticia.fonteUrl || noticia.fonteAutor || noticia.fontePublicadaEm">
      <h3>Fonte</h3>

      <p class="source-line" *ngIf="noticia.fonteNome">
        <strong>Veículo:</strong> {{ noticia.fonteNome }}
      </p>

      <p class="source-line" *ngIf="noticia.fonteAutor">
        <strong>Autor:</strong> {{ noticia.fonteAutor }}
      </p>

      <p class="source-line" *ngIf="noticia.fontePublicadaEm">
        <strong>Publicado em:</strong> {{ formatarData(noticia.fontePublicadaEm || null) }}
      </p>

      <p class="source-line" *ngIf="noticia.fonteUrl">
        <strong>Link:</strong>
        <a [href]="noticia.fonteUrl" target="_blank" rel="noopener noreferrer">
          Abrir matéria original
        </a>
      </p>
    </section>

    <!-- Footer -->
    <footer class="article-footer">
      <button class="btn-voltar" (click)="voltar()">
        <span class="material-icons">arrow_back</span>
        Voltar para notícias
      </button>
    </footer>
  </div>
</article>
