<section class="calculadora-page">
  <div class="container">
    <!-- Header -->
    <header class="header">
      <div class="icon-wrapper">
        <span class="material-icons">calculate</span>
      </div>
      <h1>Calculadora Financeira</h1>
      <p>Calcule deságio, mora, juros e multa</p>
    </header>

    <!-- Formulário -->
    <div class="calc-grid">
      <!-- Coluna Esquerda - Inputs -->
      <div class="form-card">
        <h2>
          <span class="material-icons">input</span>
          Dados do Título
        </h2>

        <div class="form-group">
          <label for="valorFace">
            <span class="material-icons">attach_money</span>
            Valor de Face
          </label>
          <input
            type="number"
            id="valorFace"
            [(ngModel)]="valorFace"
            placeholder="0,00"
            min="0"
            step="0.01"
          >
        </div>

        <div class="divider"></div>

        <h3>Deságio</h3>
        <div class="row">
          <div class="form-group">
            <label for="fatorDesagio">
              <span class="material-icons">trending_down</span>
              Fator (%)
            </label>
            <input
              type="number"
              id="fatorDesagio"
              [(ngModel)]="fatorDesagio"
              placeholder="0"
              min="0"
              step="0.01"
            >
          </div>

          <div class="form-group">
            <label for="prazoDesagio">
              <span class="material-icons">event</span>
              Prazo (dias)
            </label>
            <input
              type="number"
              id="prazoDesagio"
              [(ngModel)]="prazoDesagio"
              placeholder="0"
              min="0"
            >
          </div>
        </div>

        <div class="divider"></div>

        <h3>Atraso</h3>
        <div class="form-group">
          <label for="diasAtraso">
            <span class="material-icons">schedule</span>
            Dias de Atraso
          </label>
          <input
            type="number"
            id="diasAtraso"
            [(ngModel)]="diasAtraso"
            placeholder="0"
            min="0"
          >
        </div>

        <div class="row">
          <div class="form-group">
            <label for="percentualMora">
              <span class="material-icons">timeline</span>
              Mora (% ao mês)
            </label>
            <input
              type="number"
              id="percentualMora"
              [(ngModel)]="percentualMora"
              placeholder="0"
              min="0"
              step="0.01"
            >
          </div>

          <div class="form-group">
            <label for="percentualJuro">
              <span class="material-icons">trending_up</span>
              Juros (% ao mês)
            </label>
            <input
              type="number"
              id="percentualJuro"
              [(ngModel)]="percentualJuro"
              placeholder="0"
              min="0"
              step="0.01"
            >
          </div>
        </div>

        <div class="form-group">
          <label for="percentualMulta">
            <span class="material-icons">warning</span>
            Multa (%)
          </label>
          <input
            type="number"
            id="percentualMulta"
            [(ngModel)]="percentualMulta"
            placeholder="0"
            min="0"
            step="0.01"
          >
          <small>Cobrada apenas uma vez (1ª parcela)</small>
        </div>

        <div class="checkbox-group">
          <label class="checkbox-label">
            <input
              type="checkbox"
              [(ngModel)]="primeiraParcela"
            >
            <span>É a primeira parcela/pagamento?</span>
          </label>
        </div>

        <!-- Botões -->
        <div class="buttons">
          <button class="btn-calcular" (click)="calcular()">
            <span class="material-icons">calculate</span>
            Calcular
          </button>
          <button class="btn-limpar" (click)="limpar()">
            <span class="material-icons">refresh</span>
            Limpar
          </button>
        </div>
      </div>

      <!-- Coluna Direita - Resultado -->
      <div class="result-card" [class.show]="mostrarResultado">
        <h2>
          <span class="material-icons">receipt_long</span>
          Resultado
        </h2>

        <div class="empty" *ngIf="!mostrarResultado">
          <span class="material-icons">info</span>
          <p>Preencha os campos e clique em "Calcular"</p>
        </div>

        <div class="results" *ngIf="mostrarResultado && resultado">
          <!-- Valor Original -->
          <div class="result-item original">
            <span class="label">Valor de Face</span>
            <span class="value">{{ formatarMoeda(valorFace) }}</span>
          </div>

          <!-- Deságio -->
          <div class="result-item negative">
            <span class="label">
              <span class="material-icons">remove_circle</span>
              Deságio
            </span>
            <span class="value">- {{ formatarMoeda(resultado.desagio) }}</span>
          </div>

          <div class="formula">
            fator/30 × prazo / 100 × valor de face
          </div>

          <div class="divider"></div>

          <!-- Mora -->
          <div class="result-item positive">
            <span class="label">
              <span class="material-icons">add_circle</span>
              Mora
            </span>
            <span class="value">+ {{ formatarMoeda(resultado.mora) }}</span>
          </div>

          <div class="formula">
            (percentual/30 × dias atraso) × valor de face / 100
          </div>

          <!-- Juros -->
          <div class="result-item positive">
            <span class="label">
              <span class="material-icons">add_circle</span>
              Juros
            </span>
            <span class="value">+ {{ formatarMoeda(resultado.juro) }}</span>
          </div>

          <div class="formula">
            percentual / 30 × dias atraso × valor de face / 100
          </div>

          <!-- Multa -->
          <div class="result-item" [class.positive]="resultado.multa > 0">
            <span class="label">
              <span class="material-icons">add_circle</span>
              Multa
            </span>
            <span class="value">
              {{ resultado.multa > 0 ? '+ ' : '' }}{{ formatarMoeda(resultado.multa) }}
            </span>
          </div>

          <div class="formula">
            percentual × valor de face (apenas 1ª parcela)
          </div>

          <div class="divider thick"></div>

          <!-- Total -->
          <div class="result-item total">
            <span class="label">
              <span class="material-icons">paid</span>
              Valor Total
            </span>
            <span class="value">{{ formatarMoeda(resultado.total) }}</span>
          </div>
        </div>
      </div>
    </div>

    <!-- Fórmulas (Info) -->
    <div class="info-card">
      <h3>
        <span class="material-icons">info</span>
        Como funciona?
      </h3>
      <ul>
        <li><strong>Deságio:</strong> fator/30 × prazo / 100 × valor de face</li>
        <li><strong>Mora:</strong> (percentual/30 × dias de atraso) × valor de face / 100</li>
        <li><strong>Juro:</strong> percentual / 30 × dias de atraso × valor de face / 100</li>
        <li><strong>Multa:</strong> percentual × valor de face (cobrada apenas uma vez na 1ª parcela)</li>
      </ul>
    </div>
  </div>
</section>
