<!-- ✅ Adicionado (click)="$event.stopPropagation()" -->
<section class="forgot-shell" (click)="$event.stopPropagation()">
  <div class="forgot-card" role="region" aria-label="Área de recuperação de senha">

    <!-- ✅ BOTÃO FECHAR MODAL -->
    <button type="button" class="modal-close" (click)="close()" aria-label="Fechar recuperação de senha">
      <span class="material-icons" aria-hidden="true">close</span>
    </button>

    <!-- ✅ SPINNER NO CARD -->
    <div class="loading-overlay-card" *ngIf="loading()">
      <div class="loading-content">
        <div class="spinner-box">
          <div class="spinner-main"></div>
          <div class="spinner-ring"></div>
        </div>
        <p>Enviando e-mail...</p>
        <span class="loading-sub">Por favor, aguarde</span>
      </div>
    </div>

    <!-- HEADER -->
    <header class="forgot-head">
      <div class="brand">
        <img class="brand-logo" src="assets/logo/logoBo.png" alt="Banco Ocorrência" />
        <div class="brand-text">
          <div class="brand-title">Banco <strong>Ocorrência</strong></div>
          <div class="brand-sub">Recuperação de senha</div>
        </div>
      </div>
    </header>

    <!-- BODY -->
    <div class="forgot-body">
      <h1>Esqueceu sua senha?</h1>
      <p class="hint">
        Não se preocupe! Informe seu e-mail e enviaremos instruções para redefinir sua senha.
      </p>

      <!-- ALERTA DE SUCESSO -->
      <div class="alert success" *ngIf="successMsg() as msg" role="alert">
        <span class="material-icons" aria-hidden="true">check_circle</span>
        <div class="alert-content">
          <strong>E-mail enviado!</strong>
          <span>{{ msg }}</span>
        </div>
      </div>

      <!-- ALERTA DE ERRO -->
      <div class="alert error" *ngIf="errorMsg() as msg" role="alert">
        <span class="material-icons" aria-hidden="true">error_outline</span>
        <span>{{ msg }}</span>
      </div>

      <!-- FORMULÁRIO -->
      <form [formGroup]="form" (ngSubmit)="submit()" novalidate>

        <!-- E-MAIL -->
        <div class="field" [class.invalid]="hasError('email')">
          <label for="email">E-mail</label>
          <div class="control">
            <span class="material-icons" aria-hidden="true">mail</span>
            <input
              id="email"
              type="email"
              inputmode="email"
              autocomplete="email"
              formControlName="email"
              placeholder="seuemail@dominio.com"
              aria-describedby="emailHelp"
              [disabled]="!!successMsg()"
            />
          </div>
          <small id="emailHelp" class="help" *ngIf="hasError('email')">
            Informe um e-mail válido.
          </small>
        </div>

        <!-- BOTÃO ENVIAR -->
        <button
          class="primary"
          type="submit"
          [disabled]="loading() || !!successMsg()"
        >
          <span class="btn-content">
            <ng-container *ngIf="loading(); else iconSend">
              <span class="btn-spinner" aria-hidden="true"></span>
              <span>Enviando...</span>
            </ng-container>
            <ng-template #iconSend>
              <span class="material-icons" aria-hidden="true">send</span>
              <span>Enviar Instruções</span>
            </ng-template>
          </span>
        </button>

        <!-- INFO -->
        <div class="info-box" *ngIf="!successMsg()">
          <span class="material-icons" aria-hidden="true">info</span>
          <p>
            Você receberá um e-mail com um link para redefinir sua senha.
            O link expira em <strong>30 minutos</strong>.
          </p>
        </div>

        <!-- DIVIDER -->
        <div class="divider">
          <span>ou</span>
        </div>

        <!-- RODAPÉ -->
        <div class="foot">
          <button type="button" class="back" (click)="goToLogin()">
            <span class="material-icons" aria-hidden="true">arrow_back</span>
            Voltar para o login
          </button>
        </div>

      </form>
    </div>

  </div>
</section>
